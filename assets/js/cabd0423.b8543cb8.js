"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[58967],{3905:(e,t,a)=>{a.d(t,{Zo:()=>p,kt:()=>h});var n=a(67294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var s=n.createContext({}),d=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},p=function(e){var t=d(e.components);return n.createElement(s.Provider,{value:t},e.children)},m="mdxType",c={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},u=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,o=e.originalType,s=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),m=d(a),u=r,h=m["".concat(s,".").concat(u)]||m[u]||c[u]||o;return a?n.createElement(h,l(l({ref:t},p),{},{components:a})):n.createElement(h,l({ref:t},p))}));function h(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=a.length,l=new Array(o);l[0]=u;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i[m]="string"==typeof e?e:r,l[1]=i;for(var d=2;d<o;d++)l[d]=a[d];return n.createElement.apply(null,l)}return n.createElement.apply(null,a)}u.displayName="MDXCreateElement"},88828:(e,t,a)=>{a.d(t,{Z:()=>o});var n=a(67294),r=a(35742);function o(e){let{title:t}=e;return n.createElement(r.Z,null,n.createElement("title",null,t))}},17976:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>d,contentTitle:()=>i,default:()=>u,frontMatter:()=>l,metadata:()=>s,toc:()=>p});var n=a(87462),r=(a(67294),a(3905)),o=a(88828);const l={title:"Forecast",keywords:["machine learning","statistics","artificial intelligence","deep learning","neural networks","time series","research","feature engineering","hyperparameters","ai","ml","openbb terminal","darts","u8","u8darts","pytorch","regression","linear","models"],description:"An introduction to the OpenBB Terminal's Forecast menu and machine learning toolkit."},i=void 0,s={unversionedId:"terminal/usage/intros/forecast",id:"terminal/usage/intros/forecast",title:"Forecast",description:"An introduction to the OpenBB Terminal's Forecast menu and machine learning toolkit.",source:"@site/content/terminal/usage/intros/forecast.md",sourceDirName:"terminal/usage/intros",slug:"/terminal/usage/intros/forecast",permalink:"/terminal/usage/intros/forecast",draft:!1,editUrl:"https://github.com/OpenBB-finance/OpenBBTerminal/edit/main/website/content/terminal/usage/intros/forecast.md",tags:[],version:"current",frontMatter:{title:"Forecast",keywords:["machine learning","statistics","artificial intelligence","deep learning","neural networks","time series","research","feature engineering","hyperparameters","ai","ml","openbb terminal","darts","u8","u8darts","pytorch","regression","linear","models"],description:"An introduction to the OpenBB Terminal's Forecast menu and machine learning toolkit."},sidebar:"tutorialSidebar",previous:{title:"Fixed Income",permalink:"/terminal/usage/intros/fixedincome"},next:{title:"Forex",permalink:"/terminal/usage/intros/forex"}},d={},p=[{value:"The Forecast Menu",id:"the-forecast-menu",level:2},{value:"Loading Data",id:"loading-data",level:3},{value:"With the Load Command",id:"with-the-load-command",level:4},{value:"Via the Stocks/Crypto Menus",id:"via-the-stockscrypto-menus",level:4},{value:"Exploration",id:"exploration",level:3},{value:"Combine",id:"combine",level:4},{value:"Delete",id:"delete",level:4},{value:"Show",id:"show",level:4},{value:"Export",id:"export",level:4},{value:"Feature Engineering",id:"feature-engineering",level:3},{value:"Time Series Forecasting",id:"time-series-forecasting",level:3},{value:"Quantile Anomaly Detection",id:"quantile-anomaly-detection",level:3},{value:"Miscellaneous AI Tools",id:"miscellaneous-ai-tools",level:3},{value:"Whisper",id:"whisper",level:4},{value:"Sample Workflow #1 (Beginner)",id:"sample-workflow-1-beginner",level:2},{value:"plot",id:"plot",level:3},{value:"desc",id:"desc",level:3},{value:"expo",id:"expo",level:3},{value:"rnn",id:"rnn",level:3},{value:"Sample Workflow #2 (Advanced)",id:"sample-workflow-2-advanced",level:2},{value:"brnn",id:"brnn",level:3},{value:"regr",id:"regr",level:3}],m={toc:p},c="wrapper";function u(e){let{components:t,...a}=e;return(0,r.kt)(c,(0,n.Z)({},m,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)(o.Z,{title:"Forecast - Terminal | OpenBB Docs",mdxType:"HeadTitle"}),(0,r.kt)("p",null,"The Forecast menu is a machine learning toolkit that provides practitioners with high-level components that can quickly provide state-of-the-art results, be it with with classical or deep learning models, while also providing researchers with low-level components that can be mixed, matched and fine tuned to build new approaches and custom tuned models. Bring in multiple datasets and train machine learning models with unlimited external factors to see how underlying data may change future forecasting predictions and accuracy."),(0,r.kt)("h2",{id:"the-forecast-menu"},"The Forecast Menu"),(0,r.kt)("p",null,"The Forecast menu can be called from any location with the command:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-console"}," /forecast\n")),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://user-images.githubusercontent.com/85772166/233540050-071524c6-f374-4241-aa31-cf33b7685e22.png",alt:"The Forecast Menu"})),(0,r.kt)("p",null,"There are also methods for entering the menu with a loaded ticker symbol from either of the ",(0,r.kt)("a",{parentName:"p",href:"https://docs.openbb.co/terminal/usage/intros/crypto"},(0,r.kt)("inlineCode",{parentName:"a"},"/crypto")," menu")," and ",(0,r.kt)("a",{parentName:"p",href:"https://docs.openbb.co/terminal/usage/intros/stocks"},(0,r.kt)("inlineCode",{parentName:"a"},"/stocks")," menu")),(0,r.kt)("p",null,"The menu is divided into sections for:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Loading Data"),(0,r.kt)("li",{parentName:"ul"},"Data Exploration"),(0,r.kt)("li",{parentName:"ul"},"Feature Engineering"),(0,r.kt)("li",{parentName:"ul"},"Time Series Forecasting"),(0,r.kt)("li",{parentName:"ul"},"Anomaly Detection"),(0,r.kt)("li",{parentName:"ul"},"Miscellaneous AI Tools")),(0,r.kt)("p",null,"and the functions within these groups are described in the following sections."),(0,r.kt)("h3",{id:"loading-data"},"Loading Data"),(0,r.kt)("h4",{id:"with-the-load-command"},"With the Load Command"),(0,r.kt)("p",null,"If the Forecast menu has not been entered directly through the ",(0,r.kt)("a",{parentName:"p",href:"https://docs.openbb.co/terminal/usage/intros/crypto"},(0,r.kt)("inlineCode",{parentName:"a"},"/crypto"))," or ",(0,r.kt)("a",{parentName:"p",href:"https://docs.openbb.co/terminal/usage/intros/stocks"},(0,r.kt)("inlineCode",{parentName:"a"},"/stocks"))," menus, a dataset must be loaded before commencing any work.  Use the ",(0,r.kt)("inlineCode",{parentName:"p"},"load")," command to open one from a CSV file placed in the OpenBBUserData folder.  The paths where the auto completion engine is looking for files is printed on the screen directly above the ",(0,r.kt)("inlineCode",{parentName:"p"},"load")," command, ",(0,r.kt)("inlineCode",{parentName:"p"},"Looking for data in:")),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://user-images.githubusercontent.com/85772166/233540104-2aad880e-c077-448a-9aff-9d2f18baf19e.png",alt:"Loading Data"})),(0,r.kt)("p",null,"Use the following syntax to load a file and name a dataset, substituting ",(0,r.kt)("inlineCode",{parentName:"p"},"vix_daily")," with the name of the file."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-console"},"\nload --file vix_daily.csv --alias vix\n")),(0,r.kt)("p",null,"To refresh the screen, enter: ",(0,r.kt)("inlineCode",{parentName:"p"},"?")),(0,r.kt)("p",null,"The dataset will be listed under the ",(0,r.kt)("inlineCode",{parentName:"p"},"load")," command and display the column names within it."),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://user-images.githubusercontent.com/85772166/233540197-0222d0a6-6f08-42e3-9072-a248eeec6f53.png",alt:"Loading From a File"})),(0,r.kt)("p",null,"Repeat the process until all desired datasets have been loaded."),(0,r.kt)("h4",{id:"via-the-stockscrypto-menus"},"Via the Stocks/Crypto Menus"),(0,r.kt)("p",null,"Use the ",(0,r.kt)("inlineCode",{parentName:"p"},"load")," command, according to the nuances of each menu.  For example's sake, and to match the starting date of the previously loaded file, it will look like:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-console"},"/stocks/load SPY --start 1997-01-01/forecast\n")),(0,r.kt)("p",null,"Combine these two methods an unlimited number of times for building a more complex model and forecast."),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://user-images.githubusercontent.com/85772166/233540295-a7711fd8-992a-4561-b202-1b02a9a4aded.png",alt:"Load From Stocks Menu"})),(0,r.kt)("p",null,"With some data loaded, the first series of tools are for inspecting, managing, and exporting the sets."),(0,r.kt)("h3",{id:"exploration"},"Exploration"),(0,r.kt)("p",null,"The exploration functions are listed in the table below, along with a short description."),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"Function"),(0,r.kt)("th",{parentName:"tr",align:"right"},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"clean"),(0,r.kt)("td",{parentName:"tr",align:"right"},"Clean a dataset by filling or dropping NaNs.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"combine"),(0,r.kt)("td",{parentName:"tr",align:"right"},"Combine columns from different datasets.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"corr"),(0,r.kt)("td",{parentName:"tr",align:"right"},"Plot the correlation coefficients for dataset features.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"delete"),(0,r.kt)("td",{parentName:"tr",align:"right"},"Delete columns from dataset.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"desc"),(0,r.kt)("td",{parentName:"tr",align:"right"},"Show descriptive statistics of a dataset.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"export"),(0,r.kt)("td",{parentName:"tr",align:"right"},"Export a processed dataset.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"plot"),(0,r.kt)("td",{parentName:"tr",align:"right"},"Plot a specific columns of a loaded dataset.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"rename"),(0,r.kt)("td",{parentName:"tr",align:"right"},"Rename columns from dataset.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"season"),(0,r.kt)("td",{parentName:"tr",align:"right"},"Plot the seasonality for a dataset column.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"setndays"),(0,r.kt)("td",{parentName:"tr",align:"right"},"Set the default number of days to forecast.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"show"),(0,r.kt)("td",{parentName:"tr",align:"right"},"Show a portion of a loaded dataset.")))),(0,r.kt)("h4",{id:"combine"},"Combine"),(0,r.kt)("p",null,"When running a model, all targeted columns must be within the same dataset.  Use the ",(0,r.kt)("inlineCode",{parentName:"p"},"combine")," command to accomplish this by merging one column with another dataset."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-console"},"combine --dataset SPY -c vix.high\ncombine --dataset SPY -c vix.low\n")),(0,r.kt)("p",null,"The SPY time series now has two additional columns from the VIX dataframe, high and low."),(0,r.kt)("h4",{id:"delete"},"Delete"),(0,r.kt)("p",null,"It may be desirable to remove entire columns from the target dataset.  The syntax below removes the three columns from the SPY data loaded through the stocks menu."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-console"},"delete --delete SPY.adj_close\ndelete --delete SPY.stock_splits\ndelete --delete SPY.dividends\n")),(0,r.kt)("h4",{id:"show"},"Show"),(0,r.kt)("p",null,"After performing operations, examine the results using the ",(0,r.kt)("inlineCode",{parentName:"p"},"show")," command."),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://user-images.githubusercontent.com/85772166/233540348-e34d9342-f48e-48c1-ac0b-bef3261d8300.png",alt:"Show"})),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-console"},"show --name SPY\n")),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://user-images.githubusercontent.com/85772166/233540386-eca474d6-596b-431e-9bf0-b7154257c877.png",alt:"Show Data"})),(0,r.kt)("h4",{id:"export"},"Export"),(0,r.kt)("p",null,"To save all of the combined changes within a dataset, export it to a new file."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-console"},"export -d SPY --type csv\n")),(0,r.kt)("p",null,"This creates a new file in the ",(0,r.kt)("a",{parentName:"p",href:"https://docs.openbb.co/terminal/usage/guides/data"},"OpenBBUserData folder"),"."),(0,r.kt)("h3",{id:"feature-engineering"},"Feature Engineering"),(0,r.kt)("p",null,"The Feature Engineering section provides methods for making fast calculations with a dataset.  Each one is listed below with a short description."),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"Function"),(0,r.kt)("th",{parentName:"tr",align:"right"},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"atr"),(0,r.kt)("td",{parentName:"tr",align:"right"},"Add Average True Range")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"delta"),(0,r.kt)("td",{parentName:"tr",align:"right"},"Add % Change")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"ema"),(0,r.kt)("td",{parentName:"tr",align:"right"},"Add Exponentially Weighted Moving Average")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"mom"),(0,r.kt)("td",{parentName:"tr",align:"right"},"Add Momentum")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"roc"),(0,r.kt)("td",{parentName:"tr",align:"right"},"Add Rate of Change")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"rsi"),(0,r.kt)("td",{parentName:"tr",align:"right"},"Add Relative Strength Index")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"sto"),(0,r.kt)("td",{parentName:"tr",align:"right"},"Add Stochastic Oscillator %K and %D")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"signal"),(0,r.kt)("td",{parentName:"tr",align:"right"},"Add Price Signal (short vs. long term)")))),(0,r.kt)("p",null,"Each function will have slight variations to the command syntax, but will generally operate similarly.  Print the help dialogue as a reminder."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-console"},"usage: rsi [-d {vix,SPY}] [-c TARGET_COLUMN] [--period PERIOD] [-h]\n\nAdd rsi to dataset based on specific column.\n\noptions:\n  -d {vix,SPY}, --dataset {vix,SPY}\n                        The name of the dataset you want to select (default: None)\n  -c TARGET_COLUMN, --target-column TARGET_COLUMN\n                        The name of the specific column you want to use (default: close)\n  --period PERIOD       The period to use (default: 10)\n  -h, --help            show this help message (default: False)\n\n\nFor more information and examples, use 'about rsi' to access the related guide.\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-console"},"\nusage: atr [--close-col CLOSE_COL] [--high-col HIGH_COL] [--low-col LOW_COL] [-d {vix,SPY}]\n           [-c TARGET_COLUMN] [-h]\n\nAdd Average True Range to dataset of specific stock ticker.\n\noptions:\n  --close-col CLOSE_COL\n                        Close column name to use for Average True Range. (default: close)\n  --high-col HIGH_COL   High column name to use for Average True Range. (default: high)\n  --low-col LOW_COL     Low column name to use for Average True Range. (default: low)\n  -d {vix,SPY}, --dataset {vix,SPY}\n                        The name of the dataset you want to select (default: None)\n  -c TARGET_COLUMN, --target-column TARGET_COLUMN\n                        The name of the specific column you want to use (default: close)\n  -h, --help            show this help message (default: False)\n\nFor more information and examples, use 'about atr' to access the related guide.\n")),(0,r.kt)("p",null,"To use these commands with the default settings, apply the syntax below."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-console"},"atr -d SPY\nrsi -d SPY\n")),(0,r.kt)("p",null,"There are now two new columns in the SPY dataset, ",(0,r.kt)("inlineCode",{parentName:"p"},"true_range, RSI_10_close"),".  To keep the dataset organized, it may be worth  renaming these columns."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-console"},"rename -d SPY --oldcol RSI_10_close --newcol spy_rsi10\nrename -d SPY --oldcol true_range --newcol spy_atr\n")),(0,r.kt)("h3",{id:"time-series-forecasting"},"Time Series Forecasting"),(0,r.kt)("p",null,"This group of features applies models to a target dataset and its columns.  There are a wide selection to choose from.  Please note that this guide is meant explain how to use the functions and does not attempt to explain the models themselves.  This menu is an implementation of the ",(0,r.kt)("a",{parentName:"p",href:"https://unit8.com/resources/darts-time-series-made-easy-in-python/"},"Unit8 Darts Time Series for Python")," library."),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"Function"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Description"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Accepts Past Covariates?"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"autoselect"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Select best statistical model from AutoARIMA, AutoETS, AutoCES, MSTL, etc."),(0,r.kt)("td",{parentName:"tr",align:"left"},"No")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"autoarima"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Automatic ARIMA Model"),(0,r.kt)("td",{parentName:"tr",align:"left"},"No")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"autoces"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Automatic Complex Exponential Smoothing Model"),(0,r.kt)("td",{parentName:"tr",align:"left"},"No")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"autoets"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Automatic ETS (Error, Trend, Seasonality) Model"),(0,r.kt)("td",{parentName:"tr",align:"left"},"No")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"mstl"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Multiple Seasonalities and Trend using Loess (MSTL) Model"),(0,r.kt)("td",{parentName:"tr",align:"left"},"No")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"rwd"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Random Walk with Drift Model"),(0,r.kt)("td",{parentName:"tr",align:"left"},"No")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"seasonalnaive"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Seasonal Naive Model"),(0,r.kt)("td",{parentName:"tr",align:"left"},"No")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"expo"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Probabilistic Exponential Smoothing"),(0,r.kt)("td",{parentName:"tr",align:"left"},"No")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"theta"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Theta Method"),(0,r.kt)("td",{parentName:"tr",align:"left"},"No")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"linregr"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Probabilistic Linear Regression"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Yes")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"regr"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Regression"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Yes")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"brnn"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Block Recurrent Neural Network (RNN, LSTM, GRU)"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Yes")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"nbeats"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Neural Bayesian Estimation"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Yes")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"nhits"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Neural Hierarchical Interpolation"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Yes")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"tcn"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Temporal Convolutional Neural Network"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Yes")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"trans"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Transformer Network"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Yes")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"tft"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Temporal Fusion Transformer Network"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Yes")))),(0,r.kt)("p",null,"Within this list of models, there are two distinct categories:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Without past covariates."),(0,r.kt)("li",{parentName:"ul"},"With past covariates.")),(0,r.kt)("p",null,"The models featuring past covariates will accept an unlimited number of columns, or all columns can be chosen.  The latter being more appropriate for when a dataset contains only columns which are deemed fit for the purpose.  To use any model in its default state, all that is required is the command name and the target dataset's name.  The default target column will always be ",(0,r.kt)("inlineCode",{parentName:"p"},"close")," so, a column must be defined to run a model if the target dataset does not contain a column with this name.  With the target column as ",(0,r.kt)("inlineCode",{parentName:"p"},"close"),", the basic default syntax will look like:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-console"},"rwd -d SPY\n")),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://user-images.githubusercontent.com/85772166/233540491-34ba7cf0-dade-42d8-a165-5709ccf1e9fa.png",alt:"Random Walk Drift"})),(0,r.kt)("p",null,"Each model should be reviewed carefully to understand what the adjustable parameters are, and how they should be defined."),(0,r.kt)("h3",{id:"quantile-anomaly-detection"},"Quantile Anomaly Detection"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"anom")," performs a Quantile Anomaly detection on a given dataset.  Read more about this calculation ",(0,r.kt)("a",{parentName:"p",href:"https://unit8co.github.io/darts/generated_api/darts.ad.detectors.quantile_detector.html"},"here"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-console"},"anom -d SPY\n")),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://user-images.githubusercontent.com/85772166/233540548-1899cb39-35ef-4ea4-ac3c-1d1757f93ea8.png",alt:"Quantile Anomaly Detection"})),(0,r.kt)("h3",{id:"miscellaneous-ai-tools"},"Miscellaneous AI Tools"),(0,r.kt)("h4",{id:"whisper"},"Whisper"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"whisper")," feature allows users to transcribe, translate, and summarize videos on YouTube.  These abilities empowers users to perform deeper research than ever before, and opens the door to a more complete view of the macroeconomic landscape.  The models are not installed until the first time it is used, and they can be quite significant in size.  Performance will vary, and there is currently not a method for offloading processing to dedicated GPUs."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-console"},'whisper https://www.youtube.com/watch?v=G0Q0BtGQzrA\n\n[DISCLAIMER]: This is a beta feature that uses standard NLP models. More recent models such as GPT will be added in future releases.\n\nDownloading and Loading NLP Pipelines from cache...\n\nAll NLP Pipelines loaded.\n\nTranscribing and summarizing...\nDownloaded video "China stuck in 8 trillion dollar debt crisis | GyanJaraHatke with Sourabh Maheshwari". Generating subtitles...\nDetected language: Hindi\n100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 83567/83567 [04:25<00:00, 314.21frames/s]\n100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 11/11 [02:44<00:00, 14.99s/it]\n\n-------------------------\nSummary: Reduction: 81.38%\nSentiment: NEGATIVE: 73.2596\n-------------------------\nChina is the largest economy in the world. Usually China\'s economy is seen in the global level of the economy of America...\n')),(0,r.kt)("p",null,"A file with the transcript is saved to the OpenBBUserData folder."),(0,r.kt)("h2",{id:"sample-workflow-1-beginner"},"Sample Workflow #1 (Beginner)"),(0,r.kt)("p",null,"Let's begin by using one of the datasets we loaded in previously : ",(0,r.kt)("inlineCode",{parentName:"p"},"SPY")),(0,r.kt)("p",null,"We will be forecasting ",(0,r.kt)("inlineCode",{parentName:"p"},"5 Business days")," ahead for the remaider of these workflows unless specified."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Note:")," All models automatically perform Historical backtesting on the test split before providing a prediction."),(0,r.kt)("p",null,"We use ",(0,r.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Mean_absolute_percentage_error"},"MAPE")," for the default as it is quite convenient and scale independent since it calculates error as a percentage instead of an absolute value.  There are many more metrics to compare time series.  The metrics will compare only common slices of series when the two series are not aligned, and parallelize computation over a large number of pairs of series. Additional metrics to choose from are RMSE, MSE, and SMAPE."),(0,r.kt)("h3",{id:"plot"},"plot"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-console"},"plot SPY.close\n")),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://user-images.githubusercontent.com/85772166/233540628-cc0b58e6-6259-4893-9dfe-4fb73217a181.png",alt:"Plot"})),(0,r.kt)("h3",{id:"desc"},"desc"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-console"},"desc SPY\n")),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://user-images.githubusercontent.com/85772166/233540670-3d4df645-8fff-41a6-a4f7-0a1005dbdb11.png",alt:"Describe"})),(0,r.kt)("h3",{id:"expo"},"expo"),(0,r.kt)("p",null,"Let's use a simple ",(0,r.kt)("strong",{parentName:"p"},"Probabilistic Exponential Smoothing Model")," to predict the close price.  Keep in mind all models are performing automatic historical backtesting before providing future forecasts.  Note that all models forecast ",(0,r.kt)("inlineCode",{parentName:"p"},"close")," by default."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-console"},"expo SPY\n")),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://user-images.githubusercontent.com/85772166/233540707-1d87add0-b398-4083-9185-978e8e0bfe8c.png",alt:"Probalistic Exponential Smoothing Model"})),(0,r.kt)("h3",{id:"rnn"},"rnn"),(0,r.kt)("p",null,"We can also play with some models that are bit more advanced. As we go down the list, models begin to become larger in parameter size and complexity.  This will play a key role later on when we want to train models with ",(0,r.kt)("inlineCode",{parentName:"p"},"past_covariates")," (aka. external factors)."),(0,r.kt)("p",null,"This time lets test with a ",(0,r.kt)("strong",{parentName:"p"},"Recurrent Neural Network")," which by default uses an ",(0,r.kt)("inlineCode",{parentName:"p"},"LSTM")," backbone.  We can also choose to test out a ",(0,r.kt)("inlineCode",{parentName:"p"},"GRU")," backbone to experiment. Let's do both and see if we can improve our accuracy and reduce the overall MAPE."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-console"},"rnn SPY --forecast-only\n\nEpoch 50: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 214/214 [00:02<00:00, 77.77it/s, loss=-4.31, v_num=logs, train_loss=-4.46, val_loss=-.985]\n\nRNN model obtains MAPE: 3.13%\n")),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://user-images.githubusercontent.com/85772166/233540770-28abd8d5-c301-4d26-bd88-77287a6d71d7.png",alt:"RNN"})),(0,r.kt)("p",null,"This result expresses a different view from the Probabilistic Exponential Smoothing Model."),(0,r.kt)("p",null,"For the second task, we would like to change the model type from ",(0,r.kt)("inlineCode",{parentName:"p"},"LSTM")," --\x3e ",(0,r.kt)("inlineCode",{parentName:"p"},"GRU"),". Let's find out of this improves the MAPE score.  Use the ",(0,r.kt)("inlineCode",{parentName:"p"},"-h")," flag to understand the particular parameters one can change for RNN. (Please note that the parameters are different for each model)."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-console"},'rnn -h\n\nusage: rnn [--hidden-dim HIDDEN_DIM] [--training_length TRAINING_LENGTH] [--naive] [-d {vix,SPY}] [-c TARGET_COLUMN] [-n N_DAYS]\n           [-t TRAIN_SPLIT] [-i INPUT_CHUNK_LENGTH] [--force-reset FORCE_RESET] [--save-checkpoints SAVE_CHECKPOINTS]\n           [--model-save-name MODEL_SAVE_NAME] [--n-epochs N_EPOCHS] [--model-type MODEL_TYPE] [--dropout DROPOUT] [--batch-size BATCH_SIZE]\n           [--end S_END_DATE] [--start S_START_DATE] [--learning-rate LEARNING_RATE] [--residuals] [--forecast-only] [--export-pred-raw]\n           [--metric {rmse,mse,mape,smape}] [-h] [--export EXPORT]\n\nPerform RNN forecast (Vanilla RNN, LSTM, GRU): https://unit8co.github.io/darts/generated_api/darts.models.forecasting.rnn_model.html\n\noptions:\n  --hidden-dim HIDDEN_DIM\n                        Size for feature maps for each hidden RNN layer (h_n) (default: 20)\n  --training_length TRAINING_LENGTH\n                        The length of both input (target and covariates) and output (target) time series used during training. Generally\n                        speaking, training_length should have a higher value than input_chunk_length because otherwise during training the RNN\n                        is never run for as many iterations as it will during training. (default: 20)\n  --naive               Show the naive baseline for a model. (default: False)\n  -d {vix,SPY}, --dataset {vix,SPY}\n                        The name of the dataset you want to select (default: None)\n  -c TARGET_COLUMN, --target-column TARGET_COLUMN\n                        The name of the specific column you want to use (default: close)\n  -n N_DAYS, --n-days N_DAYS\n                        prediction days. (default: 5)\n  -t TRAIN_SPLIT, --train-split TRAIN_SPLIT\n                        Start point for rolling training and forecast window. 0.0-1.0 (default: 0.85)\n  -i INPUT_CHUNK_LENGTH, --input-chunk-length INPUT_CHUNK_LENGTH\n                        Number of past time steps for forecasting module at prediction time. (default: 14)\n  --force-reset FORCE_RESET\n                        If set to True, any previously-existing model with the same name will be reset (all checkpoints will be discarded).\n                        (default: True)\n  --save-checkpoints SAVE_CHECKPOINTS\n                        Whether to automatically save the untrained model and checkpoints. (default: True)\n  --model-save-name MODEL_SAVE_NAME\n                        Name of the model to save. (default: rnn_model)\n  --n-epochs N_EPOCHS   Number of epochs over which to train the model. (default: 300)\n  --model-type MODEL_TYPE\n                        Enter a string specifying the RNN module type ("RNN", "LSTM" or "GRU") (default: LSTM)\n  --dropout DROPOUT     Fraction of neurons affected by Dropout, from 0 to 1. (default: 0)\n  --batch-size BATCH_SIZE\n                        Number of time series (input and output) used in each training pass (default: 32)\n  --end S_END_DATE      The end date (format YYYY-MM-DD) to select for testing (default: None)\n  --start S_START_DATE  The start date (format YYYY-MM-DD) to select for testing (default: None)\n  --learning-rate LEARNING_RATE\n                        Learning rate during training. (default: 0.001)\n  --residuals           Show the residuals for the model. (default: False)\n  --forecast-only       Do not plot the historical data without forecasts. (default: False)\n  --export-pred-raw     Export predictions to a csv file. (default: False)\n  --metric {rmse,mse,mape,smape}\n                        Calculate precision based on a specific metric (rmse, mse, mape) (default: mape)\n  -h, --help            show this help message (default: False)\n  --export EXPORT       Export figure into png, jpg, pdf, svg (default: )\n\nFor more information and examples, use \'about rnn\' to access the related guide.\n')),(0,r.kt)("p",null,"Lets change the ",(0,r.kt)("inlineCode",{parentName:"p"},"--model-type")," parameter to ",(0,r.kt)("inlineCode",{parentName:"p"},"GRU")," and rerun."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-console"},"rnn SPY --model-type GRU --forecast-only\n\nEpoch 85: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 214/214 [00:02<00:00, 75.10it/s, loss=-4.45, v_num=logs, train_loss=-4.35, val_loss=-2.35]\n\nRNN model obtains MAPE: 2.77% \n")),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://user-images.githubusercontent.com/85772166/233540843-2167a3ad-0088-4d84-a298-7b8b3b3655ff.png",alt:"RNN with GRU"})),(0,r.kt)("p",null,"We improved the accuracy score, great work!"),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("p",{parentName:"admonition"},"The take away for this is that all models should work out of the box when forecasting for a particular time series. One can switch the target by specifying a ",(0,r.kt)("inlineCode",{parentName:"p"},"-c")," for ",(0,r.kt)("inlineCode",{parentName:"p"},"TARGET_COLUMN")," and test out performance with multiple different models with a single command.")),(0,r.kt)("h2",{id:"sample-workflow-2-advanced"},"Sample Workflow #2 (Advanced)"),(0,r.kt)("p",null,"To build successful models and improve accuracy over time, it is important to capture external data related to the time series you are training on. This can be seen in everyday applications:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Observed rainfalls and known weather forecasts can help to predict hydro and solar electricity production"),(0,r.kt)("li",{parentName:"ul"},"Recently-observed activity on an e-commerce website can help predict future sales."),(0,r.kt)("li",{parentName:"ul"},"Making the model aware of up-coming holidays can help sales forecasting.")),(0,r.kt)("p",null,"In fact, more often than not, strictly relying on the history of a time series\nto predict its future is missing a lot of valuable information."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Past covariates")," are time series whose past values are known at prediction\ntime. Those series often contain values that have to be observed to be known."),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://user-images.githubusercontent.com/105685594/190244764-ce8cf01f-c959-4827-a326-62b0e172332d.png",alt:"image"})),(0,r.kt)("p",null,"To explore this topic more, please read the ",(0,r.kt)("a",{parentName:"p",href:"https://medium.com/unit8-machine-learning-publication/time-series-forecasting-using-past-and-future-external-data-with-darts-1f0539585993"},"blog post")," written by the authors of Darts."),(0,r.kt)("p",null,"Note that only the following models can handle ",(0,r.kt)("inlineCode",{parentName:"p"},"past_covariates"),": ",(0,r.kt)("inlineCode",{parentName:"p"},"BlockRNNModel"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"NBEATSModel"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"TCNModel"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"TransformerModel"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"RegressionModel")," (incl. ",(0,r.kt)("inlineCode",{parentName:"p"},"LinearRegressionModel"),"), ",(0,r.kt)("inlineCode",{parentName:"p"},"Temporal Fusion Transformer")),(0,r.kt)("p",null,"Earlier on in the guide we managed to accomplish the following:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Load multiple datasets."),(0,r.kt)("li",{parentName:"ul"},"Combine datasets."),(0,r.kt)("li",{parentName:"ul"},"Rename columns."),(0,r.kt)("li",{parentName:"ul"},"Delete columns.")),(0,r.kt)("p",null,"We will continue this workflow by:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Adding some correlation analysis."),(0,r.kt)("li",{parentName:"ul"},"Train models with ",(0,r.kt)("inlineCode",{parentName:"li"},"past_covariates"),".")),(0,r.kt)("p",null,"For practice, let's start fresh and rebuild the same dataset.  The ",(0,r.kt)("a",{parentName:"p",href:"https://docs.openbb.co/terminal/usage/guides/scripts-and-routines"},"OpenBB Routine Scripts")," can make quick work out of this chore.  Copy the block below and create a new ",(0,r.kt)("inlineCode",{parentName:"p"},".openbb")," file, in ",(0,r.kt)("inlineCode",{parentName:"p"},"~/OpenBBUserData/routines/"),", to follow along."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-console"},"/stocks\nload SPY --start 1997-01-01\nforecast\n..\nload ^VIX --start 1997-01-01\nforecast\ncombine --dataset SPY -c ^VIX.high\ncombine --dataset SPY -c ^VIX.low\ndelete --delete SPY.adj_close\ndelete --delete SPY.stock_splits\ndelete --delete SPY.dividends\natr -d SPY\nrsi -d SPY\nrename -d SPY --oldcol RSI_10_close --newcol SPY_rsi10\nrename -d SPY --oldcol true_range --newcol SPY_atr\nshow SPY\n")),(0,r.kt)("p",null,"Restart the Terminal to ensure that the routine file is found by the ",(0,r.kt)("inlineCode",{parentName:"p"},"/exe")," command, and then run it."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-console"},"exe --file forecast_demo.openbb\n")),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://user-images.githubusercontent.com/85772166/233540963-b62b6f6b-a595-4cee-8ce9-8876024b3da8.png",alt:"Forecast Routine Demo"})),(0,r.kt)("h3",{id:"brnn"},"brnn"),(0,r.kt)("p",null,"Now take the new dataset and train a simple ",(0,r.kt)("inlineCode",{parentName:"p"},"Block RNN")," model on SPY's ",(0,r.kt)("inlineCode",{parentName:"p"},"close")," price, and again using ",(0,r.kt)("inlineCode",{parentName:"p"},"past_covariates")," on a single column."),(0,r.kt)("p",null,"Without past covariates:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-console"},"brnn SPY --forecast-only\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-console"},"Epoch 196: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 214/214 [00:01<00:00, 107.42it/s, loss=-4.09, v_num=logs, train_loss=-4.07, val_loss=-1.53]\n\nBlock RNN model obtains MAPE: 3.25% \n")),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://user-images.githubusercontent.com/85772166/233541019-7bc0545e-f2f1-4a6d-84a2-7e7ac1de9043.png",alt:"BRNN Without Covariates"})),(0,r.kt)("p",null,"With covariates:"),(0,r.kt)("p",null,"To use any covariates, there are two options:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"specify specific columns with ",(0,r.kt)("inlineCode",{parentName:"li"},"--past-covariates")),(0,r.kt)("li",{parentName:"ul"},"specify all columns as past covariates except the one you are forecasting\n",(0,r.kt)("inlineCode",{parentName:"li"},"--all-past-covariates"))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-console"},"brnn SPY --forecast-only --past-covariates volume\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-console"},"Covariate #0: volume\nEpoch 86: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 214/214 [00:02<00:00, 74.77it/s, loss=-4, v_num=logs, train_loss=-4.19, val_loss=-1.53]\nBlock RNN model obtains MAPE: 4.69% \n")),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://user-images.githubusercontent.com/85772166/233541054-552243aa-0509-47fd-8ac8-42c0b433095a.png",alt:"BRNN With Past Covariates"})),(0,r.kt)("p",null,"It is evident here that adding in the external variable of ",(0,r.kt)("inlineCode",{parentName:"p"},"volume")," negatively affected the accuracy."),(0,r.kt)("p",null,"Let's try adding a new column for the 200-day moving average."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-console"},"ema -d SPY --period 200/brnn -d SPY --past-covariates EMA_200\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-console"},"Successfully added 'EMA_200' to 'SPY' dataset\nCovariate #0: EMA_200\nEpoch 79: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 214/214 [00:02<00:00, 87.78it/s, loss=-3.81, v_num=logs, train_loss=-3.78, val_loss=-.435\nBlock RNN model obtains MAPE: 4.60%\n")),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://user-images.githubusercontent.com/85772166/233541105-0f8dc802-e569-4ce2-b16a-0610e1cb99b7.png",alt:"BRNN With EMA200"})),(0,r.kt)("p",null,"This isn't an improvement.  It's possible that there is too much noise in the data, so let's try shortening the length of time being used to train."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-console"},"\nbrnn -d SPY --past-covariates EMA_200 -t 0.95\n\nCovariate #0: EMA_200\nEpoch 87: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 215/215 [00:02<00:00, 82.81it/s, loss=-3.87, v_num=logs, train_loss=-4.29, val_loss=-1.59]\nBlock RNN model obtains MAPE: 3.38% \n")),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://user-images.githubusercontent.com/85772166/233541148-707d2167-46ee-47b1-b6dc-ed56b239f32f.png",alt:"Parameter Adjustments"})),(0,r.kt)("p",null,"Removing the 2020 volatility from the window of observation made a massive improvement to the forecast.  Now let's see add all the columns in the dataset as past covariates."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-console"},"brnn -d SPY --all-past-covariates -t 0.95\n\nCovariate #0: open\nCovariate #1: high\nCovariate #2: low\nCovariate #3: volume\nCovariate #4: ^VIX_high\nCovariate #5: ^VIX_low\nCovariate #6: SPY_atr\nCovariate #7: SPY_rsi10\nCovariate #8: EMA_200\nEpoch 39: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 215/215 [00:02<00:00, 83.50it/s, loss=-3.92, v_num=logs, train_loss=-4.03, val_loss=-2.14]\nBlock RNN model obtains MAPE: 3.57% \n")),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://user-images.githubusercontent.com/85772166/233541177-7ddd64be-ec79-4aaf-b30f-41607a7b7f68.png",alt:"BRNN with All Past Covariates"})),(0,r.kt)("p",null,"Adding all of the columns that were created doesn't improve the MAPE score, but it does narrow the range of forecasted prices.  Playing around like this shows how small changes can have a large impact on a forecast.  It is important to test many variables and parameters without getting too caught up overfitting any particular model.  Validate a thesis before dedicating a large amount of time into it."),(0,r.kt)("h3",{id:"regr"},"regr"),(0,r.kt)("p",null,"Using the ",(0,r.kt)("inlineCode",{parentName:"p"},"regr")," function with ",(0,r.kt)("inlineCode",{parentName:"p"},"all-past-covariates")," on the same dataset gives dramatically different forecast."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-console"},"regr SPY --all-past-covariates\n\nCovariate #0: open\nCovariate #1: high\nCovariate #2: low\nCovariate #3: volume\nCovariate #4: ^VIX_high\nCovariate #5: ^VIX_low\nCovariate #6: SPY_atr\nCovariate #7: SPY_rsi10\nPredicting Regression for 5 days\n100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 1026/1026 [00:48<00:00, 21.35it/s]\nRegression model obtains MAPE: 2.68%\n")),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://user-images.githubusercontent.com/85772166/233541224-c2cbbaba-0b33-4d79-930a-dd2629d6ed94.png",alt:"regr"})),(0,r.kt)("p",null,"Now that we know how to use covariates, and are starting to understand their effects, let's examine the impact of MSFT and AAPL closing prices on the regression forecast for SPY.  We will discard the previous work and start fresh."),(0,r.kt)("p",null,"The cache can be purged by resetting the Terminal.  Use this command to clear it:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-console"},"/r\n")),(0,r.kt)("p",null,"Now we will fetch the data and combine the columns:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-console"},"/stocks/load spy\nforecast\n..\nload aapl\nforecast\n..\nload msft\nforecast\ndelete --delete SPY.stock_splits\ndelete --delete SPY.adj_close\ndelete --delete SPY.dividends\ncombine SPY -c AAPL.close\ncombine SPY -c MSFT.close\nregr SPY --forecast-only --past-covariates AAPL_close,MSFT_close\n")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Remember: You can use unlimited number of ",(0,r.kt)("inlineCode",{parentName:"strong"},"past_covariates")," but they must all be combined into a single dataframe with the target forecast time series before training.")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-console"},"Covariate #0: AAPL_close\nCovariate #1: MSFT_close\nPredicting Regression for 5 days\n100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 115/115 [00:01<00:00, 96.07it/s]\nRegression model obtains MAPE: 1.77%\n")),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://user-images.githubusercontent.com/85772166/233541267-42a541e2-ff5f-429e-a9fd-b9d2c76060ce.png",alt:"Regression with Past Covariates"})),(0,r.kt)("p",null,"Adding the rest of the columns as past covariates improves the MAPE score slightly and starts to take a more directional view."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-console"},"regr --all-past-covariates -d SPY\n\nCovariate #0: open\nCovariate #1: high\nCovariate #2: low\nCovariate #3: volume\nCovariate #4: AAPL_close\nCovariate #5: MSFT_close\nPredicting Regression for 5 days\n100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 115/115 [00:00<00:00, 117.16it/s]\nRegression model obtains MAPE: 1.66% \n")),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://user-images.githubusercontent.com/85772166/233541328-931117ff-9a84-437d-b8e8-b653d56335bc.png",alt:"Regression with All Past Covariates"})),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("p",{parentName:"admonition"},"The examples here are over-simplified as a means for demonstrating a framework to create and conduct experiments.  It is important to keep in mind that these are tools, they are not oracles, and that results may vary.  If you have any questions, requests for new feature engineering and model additions, or just want to be part of the conversation, please join us on ",(0,r.kt)("a",{parentName:"p",href:"openbb.co/discord"},"Discord"),".  Happy hacking!")))}u.isMDXComponent=!0}}]);